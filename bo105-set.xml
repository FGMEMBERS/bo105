<?xml version="1.0"?>
<!--
************************************************************************
Bo 105 simulation config.
************************************************************************
-->

<PropertyList>
 <sim>

  <description>Eurocopter Bo105</description>

  <flight-model>yasim</flight-model>
  <aero>bo105</aero>
  <fuel-fraction>0.8</fuel-fraction>

  <sound>
   <audible>true</audible>
   <path>Aircraft/bo105/bo105-sound.xml</path>
  </sound>

  <systems>
    <electrical>
      <path>Aircraft/c172/c172-electrical.xml</path>
    </electrical>
  </systems>

  <panel>
   <visibility archive="n">false</visibility>
  </panel>

  <model>
   <path archive="y">Aircraft/bo105/Models/bo105.xml</path>
   <bo105>
    <painting>1</painting>
    <shadow-blend>0.4</shadow-blend>
   </bo105>
  </model>

  <view>
   <internal archive="y">true</internal>
   <config>
     <x-offset-m archive="y">0.38</x-offset-m><!--right-->
     <y-offset-m archive="y">0.60</y-offset-m><!--up-->
     <z-offset-m archive="y">-1.50</z-offset-m><!--back-->
     <pitch-offset-deg>-8</pitch-offset-deg>
   </config>
  </view>

  <hud>
   <enable3d>false</enable3d>
  </hud>

 </sim>

 <yasim>
  <j3cub>
   <pilot-lb>180</pilot-lb>
  </j3cub>
 </yasim>

 <controls>
  <flight>
   <aileron-trim>0.0076</aileron-trim>   <!-- fixed -->
   <elevator-trim>0.0000</elevator-trim> <!-- controllable -->
   <rudder-trim>0.0020</rudder-trim>     <!-- fixed -->
  </flight>
  <engines>
   <engine n="0">
    <magnetos>0</magnetos>
   </engine>
  </engines>
  <doors>
    <rear type="float">0.0</rear>
    <front-left type="float">0.0</front-left>
    <front-right type="float">0.0</front-right>
    <back-left type="float">0.0</back-left>
    <back-right type="float">0.0</back-right>
    <all type="float">0.0</all>
  </doors>
 </controls>

 <!-- An autopilot on a Cub??? -->  
 <autopilot>
   <config>
     <min-climb-speed-kt type="float">48.0</min-climb-speed-kt>
     <best-climb-speed-kt type="float">56.0</best-climb-speed-kt>
     <target-climb-rate-fpm type="float">400.0</target-climb-rate-fpm>
     <target-descent-rate-fpm type="float">1000.0</target-descent-rate-fpm>
     <elevator-adj-factor type="float">6000.0</elevator-adj-factor>
     <integral-contribution type="float">0.008</integral-contribution> 
     <zero-pitch-throttle type="float">0.35</zero-pitch-throttle>
     <zero-pitch-trim-full-throttle type="float">0.001</zero-pitch-trim-full-throttle>
   </config>
 </autopilot>

 <input>
  <keyboard>
   <key n="67">
    <name>C</name>
    <desc>open/close rear door</desc>
    <binding n="0">
     <command>nasal</command>
     <script>bo105.toggleDoor()</script>
    </binding>
   </key>
  </keyboard>
 </input>

 <nasal>
  <bo105>
   <script><![CDATA[
    prop = props.globals.getNode("/controls/doors/rear", 1);
    swingTime = 2.5;

    target = 1; # Start closed, so initial target is "open"
    toggleDoor = func {
        val = prop.getValue();
        time = abs(val - target) * swingTime;
        interpolate(prop, target, time);
        target = !target;
    }

    # the attitude indicator needs pressure
    settimer(func { setprop("/engines/engine/rpm", 3000) }, 8);
    print("bo105-set.xml initialized");
   ]]></script>
  </bo105>
 </nasal>
</PropertyList>
